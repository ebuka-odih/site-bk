import{r as u,u as y,j as e,a as me}from"./app-DTiM-GE2.js";import{C as x,d as h,a as b,b as g,c as _,B as o}from"./card-D9LfDUC9.js";import{M as xe}from"./MobileLayout-Bq-ZQDoB.js";import{c as he}from"./createLucideIcon-CFa8QLqb.js";/* empty css            *//**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],be=he("camera",fe);function ye({auth:t,flash:f,loginHistory:$=[]}){const P=t.user.has_transaction_pin??!1,[n,d]=u.useState("view"),z=$??[],[p,j]=u.useState(null),c=u.useRef(null),[B,C]=u.useState(!1),{data:S,setData:l,post:K,processing:E,errors:i,reset:Q,clearErrors:k}=y({name:t.user.name??"",email:t.user.email??"",phone:t.user.phone??"",profile_photo:null}),{data:D,setData:I,post:W,processing:L,errors:m,reset:G,clearErrors:H}=y({current_password:"",password:"",password_confirmation:""}),{data:X,setData:J,post:ee,processing:A,errors:U,reset:V,clearErrors:Y}=y({current_password:""}),{data:w,setData:N,post:se,processing:Z,errors:a,reset:te,clearErrors:R}=y({current_password:"",current_transaction_pin:"",transaction_pin:"",transaction_pin_confirmation:""});u.useEffect(()=>{l("name",t.user.name??""),l("email",t.user.email??""),l("phone",t.user.phone??""),l("profile_photo",null),j(s=>(s&&URL.revokeObjectURL(s),null)),c.current&&(c.current.value="")},[t.user.name,t.user.email,t.user.phone,l]),u.useEffect(()=>()=>{p&&URL.revokeObjectURL(p)},[p]),u.useEffect(()=>{B&&n==="profile"&&(c.current?.click(),C(!1))},[n,B]),u.useEffect(()=>{t?.user?.profile_photo_url?console.debug("[Profile] profile_photo_url changed",t.user.profile_photo_url):console.debug("[Profile] profile_photo_url is empty")},[t?.user?.profile_photo_url]);const q=s=>s===n?"w-full bg-blue-600 hover:bg-blue-700 text-white":"w-full border-slate-700 text-slate-300 hover:bg-slate-800",F=s=>{d(r=>r===s?"view":s)},M=s=>r=>{l(s,r.target.value),i[s]&&k(s)},re=s=>{s.preventDefault(),K(route("profile.update"),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{console.info("[Profile] Avatar upload success"),Q(),d("view"),j(r=>(r&&URL.revokeObjectURL(r),null)),c.current&&(c.current.value=""),me.reload({only:["auth"]})},onError:r=>{console.error("[Profile] Avatar upload failed",r)},onFinish:()=>{console.debug("[Profile] Avatar upload request finished")}})},ae=()=>{l("name",t.user.name??""),l("email",t.user.email??""),l("phone",t.user.phone??""),l("profile_photo",null),k(),p&&(URL.revokeObjectURL(p),j(null)),c.current&&(c.current.value=""),C(!1),d("view")},le=s=>{const r=s.target.files?.[0]??null;r?console.debug("[Profile] Selected avatar file",{name:r.name,type:r.type,size:r.size}):console.debug("[Profile] No avatar file selected"),l("profile_photo",r),i.profile_photo&&k("profile_photo"),j(v=>(v&&URL.revokeObjectURL(v),r?URL.createObjectURL(r):null))},oe=()=>{if(n!=="profile"){d("profile"),C(!0);return}c.current?.click()},T=s=>r=>{I(s,r.target.value),m[s]&&H(s)},ne=s=>{s.preventDefault(),W(route("profile.password"),{preserveScroll:!0,onSuccess:()=>{G(),d("view")},onError:()=>{I("password",""),I("password_confirmation","")}})},ie=()=>{G(),H(),d("view")},ce=s=>{J("current_password",s.target.value),U.current_password&&Y("current_password")},de=s=>{s.preventDefault(),ee(route("profile.logout-sessions"),{preserveScroll:!0,onSuccess:()=>{V(),d("view")},onError:()=>{J("current_password","")}})},ue=s=>{s.preventDefault(),se(route("profile.transaction-pin"),{preserveScroll:!0,onSuccess:()=>{te()},onError:()=>{N("transaction_pin",""),N("transaction_pin_confirmation","")}})},O=s=>r=>{const v=r.target.value.replace(/\D/g,"").slice(0,6);N(s,v),a[s]&&R(s),a.error&&R("error")},pe=s=>{N("current_password",s.target.value),a.current_password&&R("current_password")};return e.jsx(xe,{user:t.user,title:"Profile",currentRoute:"profile",children:e.jsxs("div",{className:"px-4 py-6 space-y-6",children:[(f?.success||f?.error)&&e.jsx(x,{className:"border-slate-800 bg-slate-900",children:e.jsxs(h,{className:"py-4",children:[f?.success&&e.jsx("p",{className:"text-sm text-emerald-300",children:f.success}),f?.error&&e.jsx("p",{className:"text-sm text-red-300",children:f.error})]})}),e.jsx(x,{className:"bg-slate-900 border-slate-800",children:e.jsx(h,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative w-24 h-24 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-3xl overflow-hidden",children:[p||t.user.profile_photo_url?e.jsx("img",{src:p??t.user.profile_photo_url,alt:t.user.name,className:"h-full w-full object-cover",onLoad:s=>{const r=s.currentTarget;console.info("[Profile] Avatar <img> loaded",{src:r.src})},onError:s=>{const r=s.currentTarget;console.error("[Profile] Avatar <img> failed to load",{src:r.src})}}):t.user.name.charAt(0).toUpperCase(),e.jsx("button",{type:"button",onClick:oe,className:"absolute bottom-0 right-0 flex h-8 w-8 items-center justify-center rounded-full border border-slate-800 bg-slate-900/90 text-slate-200 shadow-lg transition hover:bg-slate-800","aria-label":"Upload profile photo",children:e.jsx(be,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-50",children:t.user.name}),e.jsx("p",{className:"text-sm text-slate-400",children:t.user.email})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${t.user.status==="active"?"bg-green-500":"bg-yellow-500"}`}),e.jsx("span",{className:"text-sm text-slate-400 capitalize",children:t.user.status})]})]})})}),e.jsxs(x,{className:"bg-slate-900 border-slate-800",children:[e.jsxs(b,{children:[e.jsx(g,{className:"text-slate-50 text-lg",children:"Account Information"}),e.jsx(_,{className:"text-slate-400",children:"Your personal account details"})]}),e.jsx(h,{className:"space-y-4",children:n==="profile"?e.jsxs("form",{onSubmit:re,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-300",children:"Full Name"}),e.jsx("input",{type:"text",value:S.name,onChange:M("name"),placeholder:"Enter your full name",className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-800 px-4 py-3 text-sm text-slate-50 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),i.name&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:i.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-300",children:"Email Address"}),e.jsx("input",{type:"email",value:S.email,onChange:M("email"),placeholder:"Enter your email address",className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-800 px-4 py-3 text-sm text-slate-50 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),i.email&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:i.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-300",children:"Phone Number"}),e.jsx("input",{type:"tel",value:S.phone??"",onChange:M("phone"),placeholder:"Enter your phone number",className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-800 px-4 py-3 text-sm text-slate-50 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500"}),i.phone&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:i.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-300",children:"Profile Photo"}),e.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:le,className:"mt-1 block w-full text-sm text-slate-300 file:mr-4 file:rounded-lg file:border-0 file:bg-slate-800 file:px-4 file:py-2 file:text-sm file:font-semibold file:text-slate-50 hover:file:bg-slate-700"}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"JPG, PNG, GIF up to 2MB."}),i.profile_photo&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:i.profile_photo})]}),e.jsxs("div",{className:"flex flex-col gap-3 pt-2 sm:flex-row sm:justify-end",children:[e.jsx(o,{type:"button",variant:"outline",className:"border-slate-700 text-slate-300 hover:bg-slate-800",onClick:ae,disabled:E,children:"Cancel"}),e.jsx(o,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white",disabled:E,children:E?"Saving...":"Save Changes"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-400",children:"Full Name"}),e.jsx("p",{className:"text-sm text-slate-50 mt-1",children:t.user.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-400",children:"Email Address"}),e.jsx("p",{className:"text-sm text-slate-50 mt-1",children:t.user.email})]}),t.user.phone&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-400",children:"Phone Number"}),e.jsx("p",{className:"text-sm text-slate-50 mt-1",children:t.user.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-400",children:"Member Since"}),e.jsx("p",{className:"text-sm text-slate-50 mt-1",children:new Date(t.user.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})})]}),e.jsxs(x,{className:"bg-slate-900 border-slate-800",children:[e.jsx(b,{children:e.jsx(g,{className:"text-slate-50 text-lg",children:"Settings & Actions"})}),e.jsxs(h,{className:"space-y-3",children:[e.jsx(o,{type:"button",onClick:()=>F("profile"),className:q("profile"),variant:n==="profile"?"default":"outline",children:"Edit Profile"}),e.jsx(o,{type:"button",onClick:()=>F("password"),variant:n==="password"?"default":"outline",className:q("password"),children:"Change Password"}),e.jsx(o,{type:"button",onClick:()=>F("security"),variant:n==="security"?"default":"outline",className:q("security"),children:"Security Settings"})]})]}),n==="password"&&e.jsxs(x,{className:"bg-slate-900 border-slate-800",children:[e.jsxs(b,{children:[e.jsx(g,{className:"text-slate-50 text-lg",children:"Change Password"}),e.jsx(_,{className:"text-slate-400",children:"Choose a strong password to protect your account."})]}),e.jsx(h,{children:e.jsxs("form",{onSubmit:ne,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-300 mb-2 block",children:"Current Password"}),e.jsx("input",{type:"password",autoComplete:"current-password",value:D.current_password,onChange:T("current_password"),placeholder:"Enter current password",className:"w-full rounded-lg border border-slate-700 bg-slate-800 px-4 py-3 text-sm text-slate-50 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),m.current_password&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:m.current_password})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-300 mb-2 block",children:"New Password"}),e.jsx("input",{type:"password",autoComplete:"new-password",value:D.password,onChange:T("password"),placeholder:"Enter new password",className:"w-full rounded-lg border border-slate-700 bg-slate-800 px-4 py-3 text-sm text-slate-50 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),m.password&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:m.password})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-300 mb-2 block",children:"Confirm Password"}),e.jsx("input",{type:"password",autoComplete:"new-password",value:D.password_confirmation,onChange:T("password_confirmation"),placeholder:"Re-enter new password",className:"w-full rounded-lg border border-slate-700 bg-slate-800 px-4 py-3 text-sm text-slate-50 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),m.password_confirmation&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:m.password_confirmation})]}),e.jsxs("div",{className:"flex flex-col gap-3 pt-2 sm:flex-row sm:justify-end",children:[e.jsx(o,{type:"button",variant:"outline",className:"border-slate-700 text-slate-300 hover:bg-slate-800",onClick:ie,disabled:L,children:"Cancel"}),e.jsx(o,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white",disabled:L,children:L?"Updating...":"Update Password"})]})]})})]}),n==="security"&&e.jsxs(x,{className:"bg-slate-900 border-slate-800",children:[e.jsxs(b,{children:[e.jsx(g,{className:"text-slate-50 text-lg",children:"Security Settings"}),e.jsx(_,{className:"text-slate-400",children:"Review your recent activity, manage sessions, and update your transaction PIN."})]}),e.jsxs(h,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-200",children:"Recent Login Activity"}),z.length?e.jsx("div",{className:"mt-3 space-y-3",children:z.map(s=>e.jsxs("div",{className:"rounded-lg border border-slate-800 bg-slate-950/60 p-3 text-xs text-slate-400",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium text-slate-50",children:s.location||"Unknown location"}),e.jsx("span",{className:s.login_successful?"text-emerald-300":"text-red-300",children:s.login_successful?"Success":"Failed"})]}),e.jsxs("div",{className:"mt-1",children:[s.device||"Device unknown"," • ",s.browser||"Browser unknown"]}),e.jsxs("div",{className:"mt-1 text-slate-500",children:[s.ip_address||"IP unavailable"," • ",s.formatted_created_at]})]},s.id))}):e.jsx("p",{className:"mt-2 text-sm text-slate-400",children:"No recent login activity recorded."})]}),e.jsxs("div",{className:"rounded-lg border border-slate-800 bg-slate-950/60 p-4",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-50",children:"Log out of other sessions"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:"Enter your password to sign out from every device except this one."}),e.jsxs("form",{onSubmit:de,className:"mt-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-300",children:"Account Password"}),e.jsx("input",{type:"password",value:X.current_password,onChange:ce,placeholder:"Confirm with your password",className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-800 px-4 py-3 text-sm text-slate-50 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),U.current_password&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:U.current_password})]}),e.jsxs("div",{className:"flex flex-col gap-3 pt-2 sm:flex-row sm:justify-end",children:[e.jsx(o,{type:"button",variant:"outline",className:"border-slate-700 text-slate-300 hover:bg-slate-800",onClick:()=>{V(),Y(),d("view")},disabled:A,children:"Cancel"}),e.jsx(o,{type:"submit",className:"bg-amber-600 hover:bg-amber-700 text-white",disabled:A,children:A?"Signing out...":"Log out other sessions"})]})]})]}),e.jsxs("div",{className:"rounded-lg border border-slate-800 bg-slate-950/60 p-4",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-50",children:"Transaction PIN"}),e.jsx("p",{className:"mt-1 text-xs text-slate-400",children:P?"Update your 6-digit transfer PIN to keep transfers secure.":"Set a 6-digit PIN to authorize transfers from your account."}),a.error&&e.jsx("div",{className:"mt-3 rounded-lg border border-red-800 bg-red-900/30 px-3 py-2 text-sm text-red-300",children:a.error}),e.jsxs("form",{onSubmit:ue,className:"mt-4 space-y-4",children:[P&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-300 mb-2 block",children:"Current Transaction PIN"}),e.jsx("input",{type:"password",inputMode:"numeric",autoComplete:"one-time-code",maxLength:6,value:w.current_transaction_pin,onChange:O("current_transaction_pin"),placeholder:"Enter current PIN",className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-slate-50 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 text-center tracking-[0.5em]",required:!0}),a.current_transaction_pin&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:a.current_transaction_pin})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-300 mb-2 block",children:"New Transaction PIN"}),e.jsx("input",{type:"password",inputMode:"numeric",autoComplete:"new-password",maxLength:6,value:w.transaction_pin,onChange:O("transaction_pin"),placeholder:"Enter 6-digit PIN",className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-slate-50 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 text-center text-2xl tracking-[0.5em]",required:!0}),a.transaction_pin&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:a.transaction_pin})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-300 mb-2 block",children:"Confirm New PIN"}),e.jsx("input",{type:"password",inputMode:"numeric",autoComplete:"new-password",maxLength:6,value:w.transaction_pin_confirmation,onChange:O("transaction_pin_confirmation"),placeholder:"Re-enter 6-digit PIN",className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-slate-50 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 text-center tracking-[0.5em]",required:!0}),a.transaction_pin_confirmation&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:a.transaction_pin_confirmation})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-300 mb-2 block",children:"Confirm with Account Password"}),e.jsx("input",{type:"password",autoComplete:"current-password",value:w.current_password,onChange:pe,placeholder:"Enter your account password",className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-slate-50 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0}),a.current_password&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:a.current_password})]}),e.jsx(o,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3",disabled:Z,children:Z?"Saving PIN...":P?"Update PIN":"Set PIN"})]})]})]})]}),e.jsxs(x,{className:"bg-red-950/20 border-red-900",children:[e.jsxs(b,{children:[e.jsx(g,{className:"text-red-400 text-lg",children:"Danger Zone"}),e.jsx(_,{className:"text-red-300/60",children:"Irreversible actions"})]}),e.jsx(h,{children:e.jsx(o,{variant:"destructive",className:"w-full",children:"Close Account"})})]})]})})}export{ye as default};
